"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[7012],{3905:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return h}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=a.createContext({}),s=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},d=function(e){var t=s(e.components);return a.createElement(p.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,p=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),u=s(n),h=r,k=u["".concat(p,".").concat(h)]||u[h]||c[h]||i;return n?a.createElement(k,o(o({ref:t},d),{},{components:n})):a.createElement(k,o({ref:t},d))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=u;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var s=2;s<i;s++)o[s]=n[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},4923:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return o},contentTitle:function(){return l},metadata:function(){return p},toc:function(){return s},default:function(){return c}});var a=n(7462),r=n(3366),i=(n(7294),n(3905)),o={sidebar_position:3,title:"Building a delivery tracker app with live location and ETAs"},l=void 0,p={unversionedId:"tutorials/building-a-delivery-tracker-with-live-location-and-etas",id:"tutorials/building-a-delivery-tracker-with-live-location-and-etas",isDocsHomePage:!1,title:"Building a delivery tracker app with live location and ETAs",description:"In this tutorial, we show you how to use the Radar iOS SDK, geofences, forward geocode API, and trip tracking to build a delivery tracker app with live location and ETAs.",source:"@site/docs/tutorials/building-a-delivery-tracker-with-live-location-and-etas.mdx",sourceDirName:"tutorials",slug:"/tutorials/building-a-delivery-tracker-with-live-location-and-etas",permalink:"/documentation/tutorials/building-a-delivery-tracker-with-live-location-and-etas",editUrl:"https://github.com/radarlabs/docs/edit/main/docs/tutorials/building-a-delivery-tracker-with-live-location-and-etas.mdx",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3,title:"Building a delivery tracker app with live location and ETAs"},sidebar:"defaultSidebar",previous:{title:"Building an app with location-enabled curbside pickup",permalink:"/documentation/tutorials/building-an-app-with-location-enabled-curbside-pickup"},next:{title:"Building an app experience that changes based on location (e.g., in-store mode)",permalink:"/documentation/tutorials/building-an-app-experience-that-changes-based-on-location-in-store-mode"}},s=[{value:"Languages used",id:"languages-used",children:[]},{value:"Features used",id:"features-used",children:[]},{value:"Steps",id:"steps",children:[{value:"Step 1: Sign up for Radar",id:"step-1-sign-up-for-radar",children:[]},{value:"Step 2: Create geofences",id:"step-2-create-geofences",children:[]},{value:"Step 3: Install the Radar iOS SDK",id:"step-3-install-the-radar-ios-sdk",children:[]},{value:"Step 4: Start tracking and start a trip",id:"step-4-start-tracking-and-start-a-trip",children:[]},{value:"Step 5: Send delivery updates to the customer",id:"step-5-send-delivery-updates-to-the-customer",children:[]},{value:"Step 6: Stop tracking and stop the trip",id:"step-6-stop-tracking-and-stop-the-trip",children:[]}]},{value:"Support",id:"support",children:[]}],d={toc:s};function c(e){var t=e.components,n=(0,r.Z)(e,["components"]);return(0,i.kt)("wrapper",(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"In this tutorial, we show you how to use the Radar ",(0,i.kt)("a",{parentName:"p",href:"/sdk"},"iOS SDK"),", ",(0,i.kt)("a",{parentName:"p",href:"/geofences"},"geofences"),", ",(0,i.kt)("a",{parentName:"p",href:"/api#geocoding"},"forward geocode API"),", and ",(0,i.kt)("a",{parentName:"p",href:"/trip-tracking"},"trip tracking")," to build a delivery tracker app with live location and ETAs."),(0,i.kt)("h2",{id:"languages-used"},"Languages used"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Swift")),(0,i.kt)("h2",{id:"features-used"},"Features used"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/sdk/ios"},"iOS SDK")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/geofences"},"Geofences")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api#forward-geocode"},"Forward geocode API")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/trip-tracking"},"Trip tracking"))),(0,i.kt)("h2",{id:"steps"},"Steps"),(0,i.kt)("h3",{id:"step-1-sign-up-for-radar"},"Step 1: Sign up for Radar"),(0,i.kt)("p",null,"If you haven't already, sign up for Radar to get your API key. You can create up to 1,000 geofences and make up to 100,000 API requests per month for free."),(0,i.kt)("a",{className:"btn btn-large btn-primary",href:"https://radar.com/signup"},"Get API Keys"),(0,i.kt)("h3",{id:"step-2-create-geofences"},"Step 2: Create geofences"),(0,i.kt)("p",null,"When a delivery is placed, call the ",(0,i.kt)("a",{parentName:"p",href:"/api#upsert-a-geofence"},"geofence upsert API")," to create a geofence for the delivery. In this case, use ",(0,i.kt)("inlineCode",{parentName:"p"},"delivery")," for the geofence ",(0,i.kt)("inlineCode",{parentName:"p"},"tag")," and the delivery ID for the geofence ",(0,i.kt)("inlineCode",{parentName:"p"},"externalId"),"."),(0,i.kt)("p",null,"Optionally, set ",(0,i.kt)("inlineCode",{parentName:"p"},"disableAfter")," to disable geofence entry events the delivery date, and set ",(0,i.kt)("inlineCode",{parentName:"p"},"userId")," to the user ID of the delivery driver to enable geofence entry events only for that delivery driver."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'curl "https://api.radar.io/v1/geofences/delivery/123" \\\n  -H "Authorization: prj_live_sk_..." \\\n  -X PUT \\\n  -d "description=Delivery #123" \\\n  -d "type=circle" \\\n  -d "coordinates=[-73.97536,40.78382]" \\\n  -d "radius=50" \\\n  -d "disableAfter=2021-01-01T00:00:00.000Z" \\\n  -d "userId=456"\n')),(0,i.kt)("p",null,"If you do not already have the coordinates the delivery address, you can call the ",(0,i.kt)("a",{parentName:"p",href:"/api#forward-geocode"},"forward geocode API")," to convert the delivery address to coordinates."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'curl "https://api.radar.io/v1/geocode/forward?query=20+jay+st+brooklyn+ny" \\\n  -H "Authorization: prj_live_sk_..."\n')),(0,i.kt)("h3",{id:"step-3-install-the-radar-ios-sdk"},"Step 3: Install the Radar iOS SDK"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/sdk"},"Install the Radar SDK")," in the app used by delivery drivers."),(0,i.kt)("p",null,"Initialize the SDK in your ",(0,i.kt)("inlineCode",{parentName:"p"},"AppDelegate")," class with your publishable API key, then request location permissions."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-swift"},'import UIKit\nimport CoreLocation\nimport RadarSDK\n\n@UIApplicationMain\nclass AppDelegate: UIResponder, UIApplicationDelegate {\n\n    let locationManager = CLLocationManager()\n\n    func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -> Bool {\n        Radar.initialize(publishableKey: "prj_test_pk_...")\n\n        self.locationManager.requestWhenInUseAuthorization()\n\n        return true\n    }\n\n}\n')),(0,i.kt)("h3",{id:"step-4-start-tracking-and-start-a-trip"},"Step 4: Start tracking and start a trip"),(0,i.kt)("p",null,"When the delivery starts, start tracking to start live location tracking, start a trip to the destination geofence. Use the delivery ID, in this case ",(0,i.kt)("inlineCode",{parentName:"p"},"123"),", for the trip ",(0,i.kt)("inlineCode",{parentName:"p"},"externalId"),"."),(0,i.kt)("p",null,"If you set ",(0,i.kt)("inlineCode",{parentName:"p"},"userId")," when creating delivery geofences, ",(0,i.kt)("a",{parentName:"p",href:"/sdk/ios#identify"},"identify the user")," by calling ",(0,i.kt)("inlineCode",{parentName:"p"},"Radar.setUserId()"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-swift"},'Radar.setUserId("456")\n\nlet tripOptions = RadarTripOptions(externalId: "123")\ntripOptions.destinationGeofenceTag = "delivery"\ntripOptions.destinationGeofenceExternalId = "123"\ntripOptions.mode = .car\nRadar.startTrip(options: tripOptions)\nRadar.startTracking(trackingOptions: .continuous)\n')),(0,i.kt)("p",null,"Optionally, instead of calling ",(0,i.kt)("inlineCode",{parentName:"p"},"Radar.startTracking()"),", we can simulate a sequence of location updates from an origin to a destination with ",(0,i.kt)("inlineCode",{parentName:"p"},"Radar.mockTracking()"),". For example, to simulate a sequence of 10 location updates every 3 seconds by car from an ",(0,i.kt)("inlineCode",{parentName:"p"},"origin")," to a ",(0,i.kt)("inlineCode",{parentName:"p"},"destination"),", we can call:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-swift"},"Radar.mockTracking(\n  origin: CLLocation(latitude: 40.714708, longitude: -74.035807),\n  destination: CLLocation(latitude: 40.717410, longitude: -74.053334),\n  mode: .car,\n  steps: 10,\n  interval: 3) { (status, location, events, user) in\n\n}\n")),(0,i.kt)("h3",{id:"step-5-send-delivery-updates-to-the-customer"},"Step 5: Send delivery updates to the customer"),(0,i.kt)("p",null,"Radar generates ",(0,i.kt)("a",{parentName:"p",href:"/trip-tracking#trip-events"},"events")," when trips are updated, including ",(0,i.kt)("inlineCode",{parentName:"p"},"user.started_trip"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"user.approaching_trip_destination"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"user.arrived_at_trip_destination"),", and ",(0,i.kt)("inlineCode",{parentName:"p"},"user.stopped_trip"),"."),(0,i.kt)("p",null,"You can receive events server-side via ",(0,i.kt)("a",{parentName:"p",href:"/integrations#event-integrations"},"event integrations"),", including ",(0,i.kt)("a",{parentName:"p",href:"/integrations#event-integrations"},"webhooks"),"."),(0,i.kt)("p",null,"Listen for trip events and send text messages or push notifications to the customer with delivery updates:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"user.started_trip"),': "Your delivery is on the way! ETA {x} minutes."'),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"user.approaching_trip_destination"),': "Your delivery is almost here! Please meet your delivery driver soon."'),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"user.arrived_at_trip_destination"),': "Your delivery is here! Please meet your delivery driver now."'),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"user.stopped_trip"),': "Your delivery is complete!"')),(0,i.kt)("p",null,"Or, poll the get trip API to show a live ETA and location in the customer app."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'curl "https://api.radar.io/v1/trips/123" \\\n  -H "Authorization: prj_live_sk_..."\n')),(0,i.kt)("h3",{id:"step-6-stop-tracking-and-stop-the-trip"},"Step 6: Stop tracking and stop the trip"),(0,i.kt)("p",null,"When the delivery is complete, complete the trip and stop tracking."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-swift"},"Radar.completeTrip()\nRadar.stopTracking()\n")),(0,i.kt)("h2",{id:"support"},"Support"),(0,i.kt)("p",null,"Have questions or feedback on this documentation? Let us know! Email us at ",(0,i.kt)("a",{parentName:"p",href:"mailto:support@radar.com"},"support@radar.com"),"."))}c.isMDXComponent=!0}}]);