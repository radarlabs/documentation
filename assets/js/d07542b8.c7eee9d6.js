"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[3262],{3905:function(e,n,t){t.d(n,{Zo:function(){return u},kt:function(){return m}});var a=t(7294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var l=a.createContext({}),p=function(e){var n=a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},u=function(e){var n=p(e.components);return a.createElement(l.Provider,{value:n},e.children)},c={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},d=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=p(t),m=r,f=d["".concat(l,".").concat(m)]||d[m]||c[m]||i;return t?a.createElement(f,o(o({ref:n},u),{},{components:t})):a.createElement(f,o({ref:n},u))}));function m(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var i=t.length,o=new Array(i);o[0]=d;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,o[1]=s;for(var p=2;p<i;p++)o[p]=t[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}d.displayName="MDXCreateElement"},8215:function(e,n,t){var a=t(7294);n.Z=function(e){var n=e.children,t=e.hidden,r=e.className;return a.createElement("div",{role:"tabpanel",hidden:t,className:r},n)}},1395:function(e,n,t){t.d(n,{Z:function(){return l}});var a=t(7294),r=t(944),i=t(6010),o="tabItem_1uMI",s="tabItemActive_2DSg";var l=function(e){var n,t=e.lazy,l=e.block,p=e.defaultValue,u=e.values,c=e.groupId,d=e.className,m=a.Children.toArray(e.children),f=null!=u?u:m.map((function(e){return{value:e.props.value,label:e.props.label}})),g=null!=p?p:null==(n=m.find((function(e){return e.props.default})))?void 0:n.props.value,h=(0,r.Z)(),v=h.tabGroupChoices,k=h.setTabGroupChoices,b=(0,a.useState)(g),y=b[0],I=b[1],w=[];if(null!=c){var S=v[c];null!=S&&S!==y&&f.some((function(e){return e.value===S}))&&I(S)}var R=function(e){var n=e.currentTarget,t=w.indexOf(n),a=f[t].value;I(a),null!=c&&(k(c,a),setTimeout((function(){var e,t,a,r,i,o,l,p;(e=n.getBoundingClientRect(),t=e.top,a=e.left,r=e.bottom,i=e.right,o=window,l=o.innerHeight,p=o.innerWidth,t>=0&&i<=p&&r<=l&&a>=0)||(n.scrollIntoView({block:"center",behavior:"smooth"}),n.classList.add(s),setTimeout((function(){return n.classList.remove(s)}),2e3))}),150))},N=function(e){var n,t=null;switch(e.key){case"ArrowRight":var a=w.indexOf(e.target)+1;t=w[a]||w[0];break;case"ArrowLeft":var r=w.indexOf(e.target)-1;t=w[r]||w[w.length-1]}null==(n=t)||n.focus()};return a.createElement("div",{className:"tabs-container"},a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.Z)("tabs",{"tabs--block":l},d)},f.map((function(e){var n=e.value,t=e.label;return a.createElement("li",{role:"tab",tabIndex:y===n?0:-1,"aria-selected":y===n,className:(0,i.Z)("tabs__item",o,{"tabs__item--active":y===n}),key:n,ref:function(e){return w.push(e)},onKeyDown:N,onFocus:R,onClick:R},null!=t?t:n)}))),t?(0,a.cloneElement)(m.filter((function(e){return e.props.value===y}))[0],{className:"margin-vert--md"}):a.createElement("div",{className:"margin-vert--md"},m.map((function(e,n){return(0,a.cloneElement)(e,{key:n,hidden:e.props.value!==y})}))))}},9443:function(e,n,t){var a=(0,t(7294).createContext)(void 0);n.Z=a},944:function(e,n,t){var a=t(7294),r=t(9443);n.Z=function(){var e=(0,a.useContext)(r.Z);if(null==e)throw new Error('"useUserPreferencesContext" is used outside of "Layout" component.');return e}},9419:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return l},contentTitle:function(){return p},metadata:function(){return u},toc:function(){return c},default:function(){return m}});var a=t(7462),r=t(3366),i=(t(7294),t(3905)),o=t(1395),s=t(8215),l={title:"Building an on-premise mode"},p=void 0,u={unversionedId:"tutorials/building-an-on-premise-mode",id:"tutorials/building-an-on-premise-mode",isDocsHomePage:!1,title:"Building an on-premise mode",description:"In this tutorial, we show you how to use geofences in Radar to show an on-premise mode when a user is in a geofence.",source:"@site/docs/tutorials/building-an-on-premise-mode.mdx",sourceDirName:"tutorials",slug:"/tutorials/building-an-on-premise-mode",permalink:"/documentation/tutorials/building-an-on-premise-mode",editUrl:"https://github.com/radarlabs/docs/edit/main/docs/tutorials/building-an-on-premise-mode.mdx",tags:[],version:"current",frontMatter:{title:"Building an on-premise mode"},sidebar:"defaultSidebar",previous:{title:"Tutorials",permalink:"/documentation/tutorials"},next:{title:"Showing a notification when a user enters a geofence",permalink:"/documentation/tutorials/showing-a-notification-when-a-user-enters-a-geofence"}},c=[{value:"Steps",id:"steps",children:[{value:"Step 1: Sign up for Radar",id:"step-1-sign-up-for-radar",children:[]},{value:"Step 2: Create geofences",id:"step-2-create-geofences",children:[]},{value:"Step 3: Initialize the SDK",id:"step-3-initialize-the-sdk",children:[]},{value:"Step 4: Request foreground permissions",id:"step-4-request-foreground-permissions",children:[]},{value:"Step 5: Change the UI when the user is in a geofence",id:"step-5-change-the-ui-when-the-user-is-in-a-geofence",children:[]}]},{value:"Support",id:"support",children:[]}],d={toc:c};function m(e){var n=e.components,t=(0,r.Z)(e,["components"]);return(0,i.kt)("wrapper",(0,a.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"In this tutorial, we show you how to use ",(0,i.kt)("a",{parentName:"p",href:"/geofences"},"geofences")," in Radar to show an on-premise mode when a user is in a geofence."),(0,i.kt)("h2",{id:"steps"},"Steps"),(0,i.kt)("h3",{id:"step-1-sign-up-for-radar"},"Step 1: Sign up for Radar"),(0,i.kt)("p",null,"If you haven't already, sign up for Radar to get your API key. You can create up to 1,000 geofences and make up to 100,000 API requests per month for free."),(0,i.kt)("a",{className:"btn btn-large btn-primary",href:"https://radar.com/signup"},"Get API keys"),(0,i.kt)("h3",{id:"step-2-create-geofences"},"Step 2: Create geofences"),(0,i.kt)("p",null,"There are several ways to create geofences:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("a",{parentName:"li",href:"https://radar.com/dashboard/geofencing/geofences/new"},"Create geofence page")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("a",{parentName:"li",href:"/geofences#csv-import"},"CSV import")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("a",{parentName:"li",href:"/api#upsert-a-geofence"},"API"))),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"tag")," is a group for the geofence. For example, you could set ",(0,i.kt)("inlineCode",{parentName:"p"},"tag = venue")," for gaming, or ",(0,i.kt)("inlineCode",{parentName:"p"},"tag = restaurant")," for restaurants. In this tutorial, we're going to use ",(0,i.kt)("inlineCode",{parentName:"p"},"tag = store"),"."),(0,i.kt)("h3",{id:"step-3-initialize-the-sdk"},"Step 3: Initialize the SDK"),(0,i.kt)("p",null,"Initialize the SDK with your publishable API key."),(0,i.kt)(o.Z,{groupId:"initialize",defaultValue:"swift",values:[{label:"Swift",value:"swift"},{label:"Kotlin",value:"kotlin"},{label:"Web",value:"web"},{label:"React Native",value:"react-native"}],mdxType:"Tabs"},(0,i.kt)(s.Z,{value:"swift",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-swift"},'import UIKit\nimport RadarSDK\n\n@UIApplicationMain\nclass AppDelegate: UIResponder, UIApplicationDelegate {\n  func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -> Bool {\n    Radar.initialize(publishableKey: "prj_test_pk_...")\n    Radar.setUserId("foo")\n\n    return true\n  }\n\n}\n'))),(0,i.kt)(s.Z,{value:"kotlin",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-kotlin"},'import io.radar.sdk.Radar\n\nclass MyApplication : Application() {\n\n  override fun onCreate() {\n    super.onCreate()\n\n    Radar.initialize(this, "prj_test_pk...")\n    Radar.setUserId("foo")\n  }\n\n}\n'))),(0,i.kt)(s.Z,{value:"web",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<html>\n  <head>\n    <title>Hello, world!</title>\n    <script src="https://js.radar.com/v4/radar.min.js"><\/script>\n  </head>\n  <body>\n    <div id="content">\n    </div>\n\n    <script type="text/javascript">\n      Radar.initialize("prj_test_pk_...");\n      Radar.setUserId("foo")\n    <\/script>\n  </body>\n</html>\n'))),(0,i.kt)(s.Z,{value:"react-native",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'import React, { useState, useEffect } from "react";\nimport Radar from "react-native-radar";\n\nexport default function App() {\n  useEffect(() => {\n    Radar.initialize("prj_live_pk_...");\n    Radar.setUserId("foo")\n  }, []);\n\n  return (\n    <div id="content">\n    </div>\n  );\n}\n')))),(0,i.kt)("h3",{id:"step-4-request-foreground-permissions"},"Step 4: Request foreground permissions"),(0,i.kt)(o.Z,{groupId:"initialize",defaultValue:"swift",values:[{label:"Swift",value:"swift"},{label:"Kotlin",value:"kotlin"},{label:"Web",value:"web"},{label:"React Native",value:"react-native"}],mdxType:"Tabs"},(0,i.kt)(s.Z,{value:"swift",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-swift"},'import UIKit\nimport RadarSDK\nimport CoreLocation\n\n@UIApplicationMain\nclass AppDelegate: UIResponder, UIApplicationDelegate, CLLocationManagerDelegate {\n\n  let locationManager = CLLocationManager()\n\n  func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -> Bool {\n    Radar.initialize(publishableKey: "prj_test_pk_...")\n    Radar.setUserId("foo")\n\n    self.locationManager.delegate = self\n    self.requestLocationPermissions()\n\n    return true\n  }\n\n  func requestLocationPermissions() {\n    let status = self.locationManager.authorizationStatus\n\n    if status == .notDetermined {\n      self.locationManager.requestWhenInUseAuthorization()\n    }\n  }\n\n}\n'))),(0,i.kt)(s.Z,{value:"kotlin",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-kotlin"},'import android.Manifest\nimport android.app.AlertDialog\nimport android.content.pm.PackageManager\nimport android.os.Build\n\nimport androidx.core.app.ActivityCompat\n\nimport io.radar.sdk.Radar\n\nclass MainActivity : AppCompatActivity() {\n  private val foregroundLocationPermissionsRequestCode = 1\n\n  override fun onCreate(savedInstanceState: Bundle?) {\n    super.onCreate(savedInstanceState)\n\n    Radar.initialize(this, "prj_test_pk_...")\n    Radar.setUserId("foo")\n\n    requestLocationPermissions()\n  }\n\n  private fun requestLocationPermissions() {\n    if (ActivityCompat.checkSelfPermission(this, Manifest.permission.ACCESS_FINE_LOCATION) != PackageManager.PERMISSION_GRANTED) {\n      ActivityCompat.requestPermissions(this, arrayOf(Manifest.permission.ACCESS_COARSE_LOCATION, Manifest.permission.ACCESS_FINE_LOCATION), foregroundLocationPermissionsRequestCode)\n    }\n  }\n\n}\n'))),(0,i.kt)(s.Z,{value:"web",mdxType:"TabItem"},(0,i.kt)("p",null,"When ",(0,i.kt)("inlineCode",{parentName:"p"},"Radar.trackOnce()")," is called, the browser will automatically prompt for foreground permissions."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<html>\n  <head>\n    <title>Hello, world!</title>\n    <script src="https://js.radar.com/v4/radar.min.js"><\/script>\n  </head>\n  <body>\n    <div id="content">\n    </div>\n\n    <script type="text/javascript">\n      Radar.initialize("prj_test_pk_...");\n      Radar.setUserId("foo");\n\n      Radar.trackOnce();\n    <\/script>\n  </body>\n</html>\n'))),(0,i.kt)(s.Z,{value:"react-native",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'import React, { useState, useEffect } from "react";\nimport Radar from "react-native-radar";\n\nexport default function App() {\n  useEffect(() => {\n    Radar.initialize("prj_live_pk_...");\n    Radar.setUserId("foo")\n\n    Radar.requestPermissions(false).then((status) => {\n      // status will be "GRANTED_FOREGROUND" if permissions were granted\n    });\n  }, []);\n\n  return (\n    <div id="content">\n    </div>\n  );\n}\n')),(0,i.kt)("p",null,"Learn about platform-specific permissions in the ",(0,i.kt)("a",{parentName:"p",href:"/sdk/ios#request-permissions"},"iOS SDK documentation")," and ",(0,i.kt)("a",{parentName:"p",href:"/sdk/android#request-permissions"},"Android SDK documentation"),"."))),(0,i.kt)("h3",{id:"step-5-change-the-ui-when-the-user-is-in-a-geofence"},"Step 5: Change the UI when the user is in a geofence"),(0,i.kt)("p",null,"Call ",(0,i.kt)("inlineCode",{parentName:"p"},"Radar.trackOnce()")," to track the user's location in the foreground. In the callback, check ",(0,i.kt)("inlineCode",{parentName:"p"},"user.geofences")," to determine if the user is in a store, then change the UI to show the on-premise experience."),(0,i.kt)(o.Z,{groupId:"initialize",defaultValue:"swift",values:[{label:"Swift",value:"swift"},{label:"Kotlin",value:"kotlin"},{label:"Web",value:"web"},{label:"React Native",value:"react-native"}],mdxType:"Tabs"},(0,i.kt)(s.Z,{value:"swift",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-swift"},'import UIKit\nimport RadarSDK\nimport CoreLocation\n\n@UIApplicationMain\nclass AppDelegate: UIResponder, UIApplicationDelegate, CLLocationManagerDelegate {\n\n  let locationManager = CLLocationManager()\n\n  func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -> Bool {\n    Radar.initialize(publishableKey: "prj_test_pk_...")\n    Radar.setUserId("foo")\n\n    self.locationManager.delegate = self\n    self.requestLocationPermissions()\n\n    Radar.trackOnce { (status, location, events, user) in\n      let isInStore = user?.geofences?.contains { $0.tag == "store" }\n      if isInStore {\n        // show on-premise mode\n      }\n    }\n\n    return true\n  }\n\n  func requestLocationPermissions() {\n    let status = self.locationManager.authorizationStatus\n\n    if status == .notDetermined {\n      self.locationManager.requestWhenInUseAuthorization()\n    }\n  }\n\n}\n'))),(0,i.kt)(s.Z,{value:"kotlin",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-kotlin"},'import android.Manifest\nimport android.app.AlertDialog\nimport android.content.pm.PackageManager\nimport android.os.Build\n\nimport androidx.core.app.ActivityCompat\n\nimport io.radar.sdk.Radar\n\nclass MainActivity : AppCompatActivity() {\n  private val foregroundLocationPermissionsRequestCode = 1\n\n  override fun onCreate(savedInstanceState: Bundle?) {\n    super.onCreate(savedInstanceState)\n\n    Radar.initialize(this, "prj_test_pk_...")\n    Radar.setUserId("foo")\n\n    requestLocationPermissions()\n  }\n\n  override fun onStart() {\n    super.onStart()\n\n    Radar.trackOnce { status, location, events, user ->\n      val isInStore = user?.geofences?.any { geofence.tag == "store" }\n      if (isInStore) {\n        // show on-premise mode\n      }\n    }\n  }\n\n  private fun requestLocationPermissions() {\n    if (ActivityCompat.checkSelfPermission(this, Manifest.permission.ACCESS_FINE_LOCATION) != PackageManager.PERMISSION_GRANTED) {\n      ActivityCompat.requestPermissions(this, arrayOf(Manifest.permission.ACCESS_COARSE_LOCATION, Manifest.permission.ACCESS_FINE_LOCATION), foregroundLocationPermissionsRequestCode)\n    }\n  }\n\n}\n'))),(0,i.kt)(s.Z,{value:"web",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<html>\n  <head>\n    <title>Hello, world!</title>\n    <script src="https://js.radar.com/v4/radar.min.js"><\/script>\n  </head>\n  <body>\n    <div id="content">\n    </div>\n\n    <script type="text/javascript">\n      Radar.initialize("prj_test_pk_...");\n      Radar.setUserId("foo");\n\n      Radar.trackOnce().then((result) => {\n        const user = result.user;\n        for (const geofence of user.geofences) {\n          if (geofence.tag === \'store\') {\n            // show on-premise mode\n          }\n        }\n      }).catch((err) => {\n        // handle error\n      });\n    <\/script>\n  </body>\n</html>\n'))),(0,i.kt)(s.Z,{value:"react-native",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'import React, { useState, useEffect } from "react";\nimport Radar from "react-native-radar";\n\nexport default function App() {\n  const [isInStore, setIsInStore] = useState(false);\n\n  useEffect(() => {\n    Radar.initialize("prj_live_pk_...");\n    Radar.setUserId("foo");\n\n    Radar.requestPermissions(false).then((status) => {\n      // status will be "GRANTED_FOREGROUND" if permissions were granted\n\n      Radar.trackOnce().then((result) => {\n        const { user } = result;\n        for (const geofence of user.geofences) {\n          if (geofence.tag === \'store\') {\n            setIsInStore(true);\n          }\n        }\n      }).catch((err) => {\n        // handle error\n      });\n    });\n  }, []);\n\n  return (\n    <div id="content">\n      { isInStore ? (\n        {/* Show on-premise mode */}\n      ) : (\n        {/* Show default UI */}\n      )}\n    </div>\n  );\n}\n')))),(0,i.kt)("h2",{id:"support"},"Support"),(0,i.kt)("p",null,"Have questions or feedback on this documentation? Let us know! Email us at ",(0,i.kt)("a",{parentName:"p",href:"mailto:support@radar.com"},"support@radar.com"),"."))}m.isMDXComponent=!0},6010:function(e,n,t){function a(e){var n,t,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e))for(n=0;n<e.length;n++)e[n]&&(t=a(e[n]))&&(r&&(r+=" "),r+=t);else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function r(){for(var e,n,t=0,r="";t<arguments.length;)(e=arguments[t++])&&(n=a(e))&&(r&&(r+=" "),r+=n);return r}t.d(n,{Z:function(){return r}})}}]);