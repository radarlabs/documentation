<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-83017101-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="Documentation | Radar" href="/documentation/opensearch.xml">
<script src="js/fullstory.js" async></script><title data-react-helmet="true">Documentation - Building a delivery tracking app | Radar</title><meta data-react-helmet="true" property="og:url" content="https://radar.com/documentation/tutorials/building-a-delivery-tracking-app"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" name="description" content="Location data infrastructure | Geofencing SDK and API"><meta data-react-helmet="true" name="fb:app_id" content="1026503440803301"><meta data-react-helmet="true" name="og:site_name" content="Radar"><meta data-react-helmet="true" name="og:type" content="website"><meta data-react-helmet="true" name="og:description" content="Location data infrastructure | Geofencing SDK and API"><meta data-react-helmet="true" name="og:image" content="https://radar.com/static/image/logo-social.png"><meta data-react-helmet="true" name="og:image:url" content="https://radar.com/static/image/logo-social.png"><meta data-react-helmet="true" name="twitter:card" content="summary"><meta data-react-helmet="true" name="twitter:site" content="@radarlabs"><meta data-react-helmet="true" name="twitter:image" content="https://radar.com/static/image/logo.png"><meta data-react-helmet="true" name="twitter:description" content="Location data infrastructure | Geofencing SDK and API"><meta data-react-helmet="true" property="og:title" content="Building a delivery tracking app"><meta data-react-helmet="true" property="twitter:title" content="Building a delivery tracking app"><link data-react-helmet="true" rel="shortcut icon" href="/documentation/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://radar.com/documentation/tutorials/building-a-delivery-tracking-app"><link data-react-helmet="true" rel="alternate" href="https://radar.com/documentation/tutorials/building-a-delivery-tracking-app" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://radar.com/documentation/tutorials/building-a-delivery-tracking-app" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://HNJN02FL1I-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/documentation/assets/css/styles.18e20415.css">
<link rel="preload" href="/documentation/assets/js/runtime~main.c6fce4e9.js" as="script">
<link rel="preload" href="/documentation/assets/js/main.7832ceac.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/documentation/"><img src="/documentation/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/documentation/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div><div class="navbar__items navbar__items--right"><a href="https://radar.com/pricing" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Pricing</a><a href="https://radar.com/contact" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Contact Sales</a><a href="https://radar.com/login" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Dashboard</a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_2Fju" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_3jCp fs-unmask"><nav class="menu thin-scrollbar menu_1DcY menuWithAnnouncementBar_3IKd"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/documentation/">Overview</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Quickstart guides</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/documentation/geofences">Geofences</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Places</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Regions</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/documentation/beacons">Beacons</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/documentation/trip-tracking">Trip Tracking</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">SDK Reference</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/documentation/api">API Reference</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Integrations</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/documentation/toolkit">Toolkit</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Tutorials</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/tutorials">Overview</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/tutorials/showing-a-notification-when-a-user-enters-a-geofence">Showing a notification when a user enters a geofence</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/tutorials/building-an-app-with-location-enabled-curbside-pickup">Building an app with location-enabled curbside pickup</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/documentation/tutorials/building-a-delivery-tracking-app">Building a delivery tracking app</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/tutorials/building-an-app-experience-that-changes-based-on-location-in-store-mode">Building an app experience that changes based on location (e.g., in-store mode)</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/tutorials/building-a-store-locator-on-ios">Building a store locator on iOS</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/tutorials/localizing-a-website-based-on-current-country-or-city">Localizing a website based on current country or city</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/tutorials/detecting-location-based-fraud">Detecting location-based fraud</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/tutorials/analyzing-where-key-customer-interactions-occur">Analyzing where key customer interactions occur</a></li></ul></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/documentation/dashboard">Dashboard</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/documentation/troubleshooting">Troubleshooting</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/documentation/faqs">FAQs</a></li><li class="menuFooter_2WBS"><a class="menuHomeButton_19K4" href="https://radar.com">Back to radar.com</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row fs-unmask"><div class="col docItemCol_2rXS"><div class="docItemContainer_1EXp"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_Ftrd"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Building a delivery tracking app</h1></header><p>In this tutorial, we will build a delivery tracking iOS application which uses <a href="/documentation/trip-tracking">Trips</a> to monitor deliveries with live location tracking, progress notifications, and ETAs. The full source code for the project is ready to clone and run in the section below. This tutorial will walk step-by-step through setting up and using Radar&#x27;s location building blocks to rebuild this sample app, which allows the user to dispatch upcoming deliveries and monitor their progress from start to completion.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="source-code"></a>Source code<a class="hash-link" href="#source-code" title="Direct link to heading">#</a></h2><p> <a href="https://github.com/radarlabs/deliverytracker" target="_blank" rel="noopener noreferrer" class="btn btn-large btn-primary">GitHub Repo</a> </p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="languages-used"></a>Languages used<a class="hash-link" href="#languages-used" title="Direct link to heading">#</a></h2><ul><li>Swift</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="features-used"></a>Features used<a class="hash-link" href="#features-used" title="Direct link to heading">#</a></h2><ul><li><a href="/documentation/trip-tracking">Trip tracking</a></li><li><a href="/documentation/geofences">Geofences</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="steps"></a>Steps<a class="hash-link" href="#steps" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="step-1-set-up-your-radar-account"></a>Step 1: Set up your Radar account<a class="hash-link" href="#step-1-set-up-your-radar-account" title="Direct link to heading">#</a></h3><p>You will need a Radar account to get started with the location building blocks used in this application. <a href="https://radar.com/login" target="_blank" rel="noopener noreferrer">Log in</a> to your account, or <a href="https://radar.com/signup" target="_blank" rel="noopener noreferrer">Sign up</a> for a free account if you don&#x27;t have one yet.</p><p>Find your API keys on the <a href="https://radar.com/dashboard" target="_blank" rel="noopener noreferrer">Get Started</a> page. We will be using your Test publishable (client) key in the iOS app.</p><p> <a href="https://radar.com/signup" target="_blank" rel="noopener noreferrer" class="btn btn-large btn-primary">Get API Keys</a> </p><p>Finally, let&#x27;s create your first geofences if you haven&#x27;t done so already. We will use them as trip destinations during app development and testing. To create a geofence via the <a href="https://radar.com/dashboard" target="_blank" rel="noopener noreferrer">dashboard</a>, go to the <a href="https://radar.com/dashboard/geofences" target="_blank" rel="noopener noreferrer">Geofences page</a> and click the <em>New</em> button. Search for an address or a place, then enter a <code>description</code>, <code>tag</code>, <code>external ID</code>, and optional <code>metadata</code> as shown below.</p><p><img class="large" src="https://images.ctfassets.net/8lppgnrkmboj/1kYTXDCHc6fACgEj0E1VC5/2183d5f78001f442221c87ad6a51c9f6/Screen_Shot_2022-08-29_at_3.42.29_PM.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="step-2-install-the-radar-ios-sdk"></a>Step 2: Install the Radar iOS SDK<a class="hash-link" href="#step-2-install-the-radar-ios-sdk" title="Direct link to heading">#</a></h3><p>Create an Xcode project with a SwiftUI interface, named <code>DeliveryTracker</code>.</p><p>The recommended method of installing the iOS SDK is with Cocoapods. See the <a href="/documentation/sdk/ios#install-sdk">iOS SDK</a> docs for alternatives.</p><p>Install <a href="https://cocoapods.org" target="_blank" rel="noopener noreferrer">CocoaPods</a>. If you don&#x27;t have an existing <code>Podfile</code>, run <code>pod init</code> in your project directory. Add the following to your <code>Podfile</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><pre tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">pod &#x27;RadarSDK&#x27;, &#x27;~&gt; 3.5.0&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Then, run <code>pod install</code>. You may also need to run <code>pod repo update</code>.</p><div class="alert alert_19nB alertInfo_1EfW" role="alert">After installing, close your project, and open the .xcodeworkspace instead. in Xcode instead of the <code>.xcproject</code> file.</div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="step-3-initialize-the-sdk"></a>Step 3: Initialize the SDK<a class="hash-link" href="#step-3-initialize-the-sdk" title="Direct link to heading">#</a></h3><p>Create a new Swift file named <code>LocationManager.swift</code>, where we define a <code>LocationManager</code> class to handle location-related logic, and create a shared instance to be used across the app. Initialize the SDK in this class with your publishable <a href="https://radar.com/dashboard" target="_blank" rel="noopener noreferrer">API key</a>, and set this class to be the <code>CLLocationManager</code> delegate.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><pre tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">import Foundation</span></span><span class="token-line" style="color:#393A34"><span class="token plain">import RadarSDK</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">class LocationManager: NSObject, ObservableObject, CLLocationManagerDelegate {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    let locationManager = CLLocationManager()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    static let shared = LocationManager()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    override init() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        super.init()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        Radar.initialize(publishableKey: &quot;prj_test_pk...&quot;)</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        self.locationManager.delegate = self</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Finally, add an @ObservedObject property to the <code>DeliveryTrackerApp</code> class in <code>DeliveryTrackerApp.swift</code> as shown below.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><pre tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">@ObservedObject var locationManager = LocationManager.shared</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="step-4-request-location-permissions"></a>Step 4: Request location permissions<a class="hash-link" href="#step-4-request-location-permissions" title="Direct link to heading">#</a></h3><p>Before requesting permissions, you must add location usage strings to the custom iOS Target Properties found in the Info tab of the app settings. To request foreground permissions in the app, add a new property with the key <code>NSLocationWhenInUseUsageDescription</code> (<em>Privacy - Location When In Use Usage Description</em>). The value is displayed in the location permission prompts. Enter a message such as <code>Your location will be used to share ETA and arrival notifications to customers</code>.</p><p><img class="large" src="https://images.ctfassets.net/8lppgnrkmboj/4pAq86XYVNhXq27DTfzUAi/f41c1bcf60cb0266c37c7970f4c27e12/updatedinfoplist.gif"></p><p>Then, request these permissions in the app by adding the following into the <code>LocationManager</code> class:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><pre tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">func locationManager(_ manager: CLLocationManager, didChangeAuthorization status: CLAuthorizationStatus) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        self.requestLocationPermissions()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">func requestLocationPermissions() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    let status = CLLocationManager.authorizationStatus()</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    if status == .notDetermined {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        self.locationManager.requestWhenInUseAuthorization()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    if status == .authorizedAlways || status == .authorizedWhenInUse {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        print(&quot;Location permissions granted&quot;)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="checkpoint-launch-app-and-grant-location-permissions"></a>Checkpoint: Launch app and grant location permissions!<a class="hash-link" href="#checkpoint-launch-app-and-grant-location-permissions" title="Direct link to heading">#</a></h3><p>At this point, you should be able to launch the app and see a prompt asking for location permissions. Accept these permissions!</p><p>If you are following the step-by-step app implementation in this tutorial, let&#x27;s set up the sample app skeleton at this point. Copy these SwiftUI view files from the <a href="https://github.com/radarlabs/deliverytracker" target="_blank" rel="noopener noreferrer">source code</a> or this <a href="https://assets.ctfassets.net/8lppgnrkmboj/2K0sMrIXqlLpMaf5fEZoTL/883324a82709279dbb966180344135f8/tutorial-files.zip" target="_blank" rel="noopener noreferrer">zip file</a> into your project: <code>JobListView.swift</code>, <code>DispatchJobView.swift</code>, <code>AcceptedJobDetailView.swift</code>, <code>JobCard.swift</code>, <code>JobDetailView.swift</code>. Copy over <code>Job.swift</code> as well, which defines the Job struct and contains sample jobs. Then in <code>DeliveryTrackerApp.swift</code>, set <code>JobListView</code> to be the scene in the App body:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><pre tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">var body: some Scene {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      WindowGroup {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          JobListView()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>In the next few steps, we will set up trip tracking capabilities to power these skeleton components.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="step-5-add-trip-start-logic"></a>Step 5: Add trip start logic<a class="hash-link" href="#step-5-add-trip-start-logic" title="Direct link to heading">#</a></h3><p>When a delivery starts, we create a trip to the destination geofence and start tracking the live location for the user. From the source code, <code>DispatchJobDetailView.swift</code> contains the button to start a trip for a given job. We will now define its action <code>startOrStopTrip</code> in the <code>LocationManager</code> class.</p><p>The button action contains trip start logic (and trip cancel logic for in progress trips) as shown below. We use a uuid for the trip <code>externalId</code>, although existing delivery ids should be used here when applicable. Set your destination geofence from <a href="/documentation/tutorials/building-a-delivery-tracking-app#step-1-set-up-your-radar-account">Step 1</a>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><pre tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">@Published var onTrip = false</span></span><span class="token-line" style="color:#393A34"><span class="token plain">var activeTrip = &quot;&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">func startOrStopTrip(job: Job) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    if !onTrip {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        let uuid = UUID().uuidString</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        let tripOptions = RadarTripOptions(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            externalId: String(uuid),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            // TODO: Fill in geofence from Step 1</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            destinationGeofenceTag:&quot;delivery_location&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            destinationGeofenceExternalId: &quot;123&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        )</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        tripOptions.mode = .car</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        tripOptions.metadata = [</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;Pickup Title&quot;: job.title,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;Vehicle&quot;: &quot;Green Ford pickup truck&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        ]</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        Radar.startTrip(options: tripOptions)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        print(&quot;Trip started&quot;, uuid)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span></span><span class="token-line" style="color:#393A34"><span class="token plain">        // TODO: Replace with your test origin and destination locations</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        Radar.mockTracking(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          origin: CLLocation(latitude: 37.769722, longitude: -122.476944),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          destination: CLLocation(latitude: 37.7897442, longitude: -122.3972337),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          mode: .car,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          steps: 10,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          interval: 2) { (status, location, events, user) in</span></span><span class="token-line" style="color:#393A34"><span class="token plain">              print(&quot;mock track&quot;, status, location)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span></span><span class="token-line" style="color:#393A34"><span class="token plain">        activeTrip = uuid</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        onTrip = true</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    } else {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        Radar.cancelTrip()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        Radar.stopTracking()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        print(&quot;Trip cancelled&quot;, activeTrip)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        onTrip = false</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Notice that we use <code>Radar.mockTracking()</code> instead of <a href="/documentation/api#track">track</a> for now, which helps simulate a sequence of location updates from an origin to a destination quickly for testing. In this case, we simulate a sequence of 10 location updates, each 2 seconds apart, by car from the <code>origin</code> to the <code>destination</code>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="step-6-add-trip-completion-logic"></a>Step 6: Add trip completion logic<a class="hash-link" href="#step-6-add-trip-completion-logic" title="Direct link to heading">#</a></h3><p>We will use arrival at the trip destination as a signal that the delivery is complete. To do this, we need to listen for the corresponding event, then complete the trip and stop tracking when it is detected. Update the <code>LocationManager</code> to be our <code>RadarDelegate</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><pre tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">class LocationManager: NSObject, ObservableObject, CLLocationManagerDelegate, RadarDelegate</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Then, add a <code>didReceiveEvents</code> method with trip completion logic when it is called with the <code>userArrivedAtTripDestination</code> event type, and add in the other RadarDelgate methods:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><pre tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">// RadarDelegate methods</span></span><span class="token-line" style="color:#393A34"><span class="token plain">func didReceiveEvents(_ events: [RadarEvent], user: RadarUser?) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    for event in events {            </span></span><span class="token-line" style="color:#393A34"><span class="token plain">        if event.type == RadarEventType.userArrivedAtTripDestination {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            Radar.completeTrip()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            Radar.stopTracking()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            print(&quot;Trip completed&quot;, activeTrip)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">func didUpdateLocation(_ location: CLLocation, user: RadarUser) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    return</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span></span><span class="token-line" style="color:#393A34"><span class="token plain">func didUpdateClientLocation(_ location: CLLocation, stopped: Bool, source: RadarLocationSource) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    return</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">func didFail(status: RadarStatus) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    return</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">func didLog(message: String) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    return</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="checkpoint-create-a-trip"></a>Checkpoint: Create a trip!<a class="hash-link" href="#checkpoint-create-a-trip" title="Direct link to heading">#</a></h3><p>With the steps we&#x27;ve covered so far, you are ready to create your first trip in the app! Run the app, and click the start button in the DispatchJobView. Now head to the <a href="https://radar.com/dashboard/trips" target="_blank" rel="noopener noreferrer">Trips</a> page where you will find all current and past trips. Ensure that a new trip appears in the started state at the top of your dashboard. With mock tracking automatically making progress on the trip in the background, the trip status should change to completed within the next minute.</p><p><img class="large" src="https://images.ctfassets.net/8lppgnrkmboj/2HpKQDmFmej13PJRdoZH96/080ed748c888a5a20c852d9e164e8583/Screen_Shot_2022-08-29_at_1.28.23_PM.png"></p><p>In the final few steps, we will surface the progress of the trip in app by sending notifications on status updates and adding a live map view with an ETA.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="step-7-send-trip-update-notifications"></a>Step 7: Send trip update notifications<a class="hash-link" href="#step-7-send-trip-update-notifications" title="Direct link to heading">#</a></h3><p>Next, we will set up notifications for key trip updates. First, in a new file titled <code>NotificationManager.swift</code>, define a <code>LocalNotificationManager</code> as shown below:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><pre tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">import Foundation</span></span><span class="token-line" style="color:#393A34"><span class="token plain">import RadarSDK</span></span><span class="token-line" style="color:#393A34"><span class="token plain">import MapKit</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">class LocalNotificationManager: NSObject, ObservableObject, UNUserNotificationCenterDelegate {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    var notifications = [Notification]()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    override init() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        super.init()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        UNUserNotificationCenter.current().requestAuthorization(options: [.alert, .badge, .sound]) { granted, error in</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            if granted == true &amp;&amp; error == nil {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                print(&quot;Notifications permitted&quot;)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            } else {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                print(&quot;Notifications not permitted&quot;)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        UNUserNotificationCenter.current().delegate = self</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    func sendNotification(title: String, subtitle: String?, body: String, launchIn: Double) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        let content = UNMutableNotificationContent()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        content.title = title</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        if let subtitle = subtitle {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            content.subtitle = subtitle</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        content.body = body</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span></span><span class="token-line" style="color:#393A34"><span class="token plain">        let trigger = UNTimeIntervalNotificationTrigger(timeInterval: launchIn, repeats: false)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        let request = UNNotificationRequest(identifier: &quot;demoNotification&quot;, content: content, trigger: trigger)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span></span><span class="token-line" style="color:#393A34"><span class="token plain">        UNUserNotificationCenter.current().add(request, withCompletionHandler: nil)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    func userNotificationCenter(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      _ center: UNUserNotificationCenter,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      willPresent notification: UNNotification,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      withCompletionHandler completionHandler: (UNNotificationPresentationOptions) -&gt; Void</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        completionHandler(.banner)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Then initialize a <code>LocalNotificationManager</code> in the <code>LocationManager</code> class.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><pre tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">var notificationManager = LocalNotificationManager()</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Finally, we need to update the listener logic from Step 6 in <code>LocationManager</code> to the following in order to send notifications:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><pre tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">func didReceiveEvents(_ events: [RadarEvent], user: RadarUser?) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    for event in events {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        if event.type == RadarEventType.userStartedTrip {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            self.notificationManager.sendNotification(title: &quot;Your mover is on the way!&quot;, subtitle: nil, body: &quot;Your mover is headed toward the pickup location. We will notify you when they are close!&quot;, launchIn: 0.1)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        if event.type == RadarEventType.userApproachingTripDestination {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            var eta = 5 // Temporarily placeholder, we will update this in Step 8</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            self.notificationManager.sendNotification(title: &quot;Your mover is approaching!&quot;, subtitle: nil, body: &quot;Your mover is &quot; + String(eta) + &quot; minutes away. Get ready to meet them at the pickup location.&quot;, launchIn: 0.1)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span></span><span class="token-line" style="color:#393A34"><span class="token plain">        if event.type == RadarEventType.userArrivedAtTripDestination {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            self.notificationManager.sendNotification(title: &quot;Your mover is here!&quot;, subtitle: nil, body: &quot;Meet them and get going with your pick up!&quot;, launchIn: 0.1)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span></span><span class="token-line" style="color:#393A34"><span class="token plain">            Radar.completeTrip()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            Radar.stopTracking()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>You should now see notifications as a trip progresses!</p><p class="text--center"><img class="large" src="https://images.ctfassets.net/8lppgnrkmboj/3NIihQVE7r83Yb4H9umdhZ/606219a3279dd989e32aac700ffbdd29/approachingnotification_sampleapp.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="step-8-display-live-map-location-and-eta"></a>Step 8: Display live map location and ETA<a class="hash-link" href="#step-8-display-live-map-location-and-eta" title="Direct link to heading">#</a></h3><p>Lastly, we will create a map view with live location tracking for the ongoing trip, complete with a live ETA.</p><p>Create this map view in a new view file named <code>TrackMapView.swift</code> with the following content:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><pre tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">import SwiftUI</span></span><span class="token-line" style="color:#393A34"><span class="token plain">import MapKit</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">struct TrackMapView: View {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    @ObservedObject var locationManager = LocationManager.shared</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    var body: some View {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        NavigationView {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            VStack {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                Map(coordinateRegion: $locationManager.region, showsUserLocation: true, annotationItems: locationManager.currentLocation == nil ? [] :</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                        [Marker(location: MapMarker(coordinate: locationManager.currentLocation!.coordinate, tint: .red))])</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                    marker in marker.location</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                }.ignoresSafeArea()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                .accentColor(Color(.systemBlue))</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span></span><span class="token-line" style="color:#393A34"><span class="token plain">                Text(&quot;ETA: \(locationManager.eta) minutes&quot;)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .font(.headline)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .foregroundColor(.accentColor)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>This view uses the shared instance of the location manager as an observed variable to refresh the map markers, region, and ETA when there are location updates. Now, update the <code>LocationManager</code> with definitions for the published variables that will hold this information, and a create a new method named <code>updateCurrentLocation</code> to handle location updates as shown below.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><pre tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">@Published var region = MKCoordinateRegion(center: CLLocationCoordinate2D(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    latitude: 37.7897, longitude: -122.3972</span></span><span class="token-line" style="color:#393A34"><span class="token plain">), span: MKCoordinateSpan(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    latitudeDelta: 0.1, longitudeDelta: 0.1</span></span><span class="token-line" style="color:#393A34"><span class="token plain">))</span></span><span class="token-line" style="color:#393A34"><span class="token plain">@Published var eta = 0</span></span><span class="token-line" style="color:#393A34"><span class="token plain">@Published var currentLocation: CLLocation?</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">func updateCurrentLocation(event: RadarEvent) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    currentLocation = event.location</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    region = MKCoordinateRegion(center: event.location.coordinate, span: MKCoordinateSpan(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        latitudeDelta: 0.1, longitudeDelta: 0.1))</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    if event.trip != nil {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        eta = Int(event.trip!.etaDuration)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Finally, call the <code>updateCurrentLocation</code> method in <code>didReceiveEvents</code> for trip events.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly swift"><pre tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">func didReceiveEvents(_ events: [RadarEvent], user: RadarUser?) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    for event in events {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span></span><span class="token-line" style="color:#393A34"><span class="token plain">        if event.type == RadarEventType.userStartedTrip {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            updateCurrentLocation(event: event)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span></span><span class="token-line" style="color:#393A34"><span class="token plain">            self.notificationManager.sendNotification(title: &quot;Your mover is on the way!&quot;, subtitle: nil, body: &quot;Your mover is headed toward the pickup location. We will notify you when they are close!&quot;, launchIn: 0.1)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        if event.type == RadarEventType.userApproachingTripDestination {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            updateCurrentLocation(event: event)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span></span><span class="token-line" style="color:#393A34"><span class="token plain">            self.notificationManager.sendNotification(title: &quot;Your mover is approaching!&quot;, subtitle: nil, body: &quot;Your mover is &quot; + String(eta) + &quot; minutes away. Get ready to meet them at the pickup location.&quot;, launchIn: 0.1)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span></span><span class="token-line" style="color:#393A34"><span class="token plain">        if event.type == RadarEventType.userArrivedAtTripDestination {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            updateCurrentLocation(event: event)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span></span><span class="token-line" style="color:#393A34"><span class="token plain">            self.notificationManager.sendNotification(title: &quot;Your mover is here!&quot;, subtitle: nil, body: &quot;Meet them and get going with your pick up!&quot;, launchIn: 0.1)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span></span><span class="token-line" style="color:#393A34"><span class="token plain">            Radar.completeTrip()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            Radar.stopTracking()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            print(&quot;Trip completed&quot;, activeTrip)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span></span><span class="token-line" style="color:#393A34"><span class="token plain">        if event.type == RadarEventType.userUpdatedTrip {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            updateCurrentLocation(event: event)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The <code>currentLocation</code>, <code>region</code>, and <code>eta</code> variables update with events in the listener logic, and the map view refreshes as they change. You should now see the live map view and ETAs for your trips in the app!</p><p class="text--center"><video width="450" height="976" controls=""><source src="https://videos.ctfassets.net/8lppgnrkmboj/57IsKRqArgn2sZta5Qs4nX/361764bc0f9688c4c2a729c4d3ea4a05/mapviewvideo_sampleapp.mp4" type="video/mp4">Your browser does not support the video tag.</video></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="step-9-next-steps"></a>Step 9: Next steps<a class="hash-link" href="#step-9-next-steps" title="Direct link to heading">#</a></h3><p>Congratulations on finishing the tutorial! This is an illustrative example to get started with <a href="/documentation/trip-tracking">trip tracking</a>. Here are some next steps and considerations before using these features in a production setting:</p><p>1) On trip start, replace the mock tracking call with <code>Radar.startTracking</code> in the application that delivery drivers to be tracked will be using.</p><p>2) Set trip destinations to geofences with delivery locations instead of the test geofence. Geofences can also be created programatically via the <a href="/documentation/api#upsert-a-geofence">geofence upsert API</a>.</p><p>3) Use <a href="/documentation/tutorials/integrations/braze">Braze</a> to send push instead of local notifications to other users with different devices.</p><p>Explore resources on the <a href="/documentation/trip-tracking">Trip Tracking page</a>, <a href="/documentation/api">API documentation</a>, and <a href="/documentation/sdk">SDK guides</a> for more information.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="support"></a>Support<a class="hash-link" href="#support" title="Direct link to heading">#</a></h2><p>Have questions or feedback on this documentation? Let us know! Email us at <a href="mailto:support@radar.com" target="_blank" rel="noopener noreferrer">support@radar.com</a>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/radarlabs/docs/edit/main/docs/tutorials/building-a-delivery-tracking-app.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/documentation/tutorials/building-an-app-with-location-enabled-curbside-pickup"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label"> Building an app with location-enabled curbside pickup</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/documentation/tutorials/building-an-app-experience-that-changes-based-on-location-in-store-mode"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Building an app experience that changes based on location (e.g., in-store mode) </div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#source-code" class="table-of-contents__link">Source code</a></li><li><a href="#languages-used" class="table-of-contents__link">Languages used</a></li><li><a href="#features-used" class="table-of-contents__link">Features used</a></li><li><a href="#steps" class="table-of-contents__link">Steps</a><ul><li><a href="#step-1-set-up-your-radar-account" class="table-of-contents__link">Step 1: Set up your Radar account</a></li><li><a href="#step-2-install-the-radar-ios-sdk" class="table-of-contents__link">Step 2: Install the Radar iOS SDK</a></li><li><a href="#step-3-initialize-the-sdk" class="table-of-contents__link">Step 3: Initialize the SDK</a></li><li><a href="#step-4-request-location-permissions" class="table-of-contents__link">Step 4: Request location permissions</a></li><li><a href="#checkpoint-launch-app-and-grant-location-permissions" class="table-of-contents__link">Checkpoint: Launch app and grant location permissions!</a></li><li><a href="#step-5-add-trip-start-logic" class="table-of-contents__link">Step 5: Add trip start logic</a></li><li><a href="#step-6-add-trip-completion-logic" class="table-of-contents__link">Step 6: Add trip completion logic</a></li><li><a href="#checkpoint-create-a-trip" class="table-of-contents__link">Checkpoint: Create a trip!</a></li><li><a href="#step-7-send-trip-update-notifications" class="table-of-contents__link">Step 7: Send trip update notifications</a></li><li><a href="#step-8-display-live-map-location-and-eta" class="table-of-contents__link">Step 8: Display live map location and ETA</a></li><li><a href="#step-9-next-steps" class="table-of-contents__link">Step 9: Next steps</a></li></ul></li><li><a href="#support" class="table-of-contents__link">Support</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/documentation/assets/js/runtime~main.c6fce4e9.js"></script>
<script src="/documentation/assets/js/main.7832ceac.js"></script>
</body>
</html>